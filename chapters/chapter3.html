<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>metaSurvey - 3&nbsp; Antecedentes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter4.html" rel="next">
<link href="../chapters/chapter2.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/chapter3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Antecedentes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">metaSurvey</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/metaSurveyR/informe_tfg" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../metaSurvey.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descripción del proyecto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Marco conceptual</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Antecedentes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Metodología</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Resultados</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Apendice aburrido de muestreo</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#investigación-reproducible" id="toc-investigación-reproducible" class="nav-link active" data-scroll-target="#investigación-reproducible"><span class="header-section-number">3.1</span> Investigación reproducible</a>
  <ul class="collapse">
  <li><a href="#conceptos-clave" id="toc-conceptos-clave" class="nav-link" data-scroll-target="#conceptos-clave"><span class="header-section-number">3.1.1</span> Conceptos clave</a></li>
  <li><a href="#workflow-reproducible" id="toc-workflow-reproducible" class="nav-link" data-scroll-target="#workflow-reproducible"><span class="header-section-number">3.1.2</span> Workflow reproducible</a></li>
  </ul></li>
  <li><a href="#investigación-reproducible-en-r" id="toc-investigación-reproducible-en-r" class="nav-link" data-scroll-target="#investigación-reproducible-en-r"><span class="header-section-number">3.2</span> Investigación reproducible en R</a>
  <ul class="collapse">
  <li><a href="#herramientas-para-el-procesamiento-de-encuestas" id="toc-herramientas-para-el-procesamiento-de-encuestas" class="nav-link" data-scroll-target="#herramientas-para-el-procesamiento-de-encuestas"><span class="header-section-number">3.2.1</span> Herramientas para el procesamiento de encuestas</a></li>
  </ul></li>
  <li><a href="#diseño-de-encuestas-y-estimación-de-varianza" id="toc-diseño-de-encuestas-y-estimación-de-varianza" class="nav-link" data-scroll-target="#diseño-de-encuestas-y-estimación-de-varianza"><span class="header-section-number">3.3</span> Diseño de encuestas y estimación de varianza</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/metaSurveyR/informe_tfg/edit/main/chapters/chapter3.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/metaSurveyR/informe_tfg/blob/main/chapters/chapter3.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li><li><a href="https://github.com/metaSurveyR/informe_tfg/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-Chapter3" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Antecedentes</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
p {
  text-align: justify
}
</style>
</div>
<div class="status">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advertencia
</div>
</div>
<div class="callout-body-container callout-body">
<p>Este capítulo está en proceso de escritura. Consulte la rama de desarrollo para ver el avance del capítulo</p>
</div>
</div>
</div>
<p>En este capitulo se presentan los antecedentes y conceptos aplicados en el desarrollo de <code>metasurvey</code> considerando conceptos de investigación reproducible, la importancia de R como herramienta para la investigación reproducible, la revisión de paquetes de R para el procesamiento de encuestas por muestreo y la importancia del diseño muestral, la importancia de la estimación de las varianzas en la generación de indicadores y los trabajos previos en los que se basa el paquete. Estos conceptos son fundamentales para poder entender el desarrollo y la importancia de tener un flujo de trabajo para la generación de indicadores sociales.</p>
<p>En la actualidad, la generación de indicadores sociales se ha vuelto una tarea fundamental tanto para la toma de decisiones como para la investigación. Sin embargo, este proceso puede ser complejo, requiriendo conocimiento sobre el formulario de la encuesta, formas de constuir ciertos indices o variables auxiliares que no necesariamente sea trivial y depende de la experiencia del usuario.</p>
<p>Este proceso de generación de indicadores en algunos casos no es transparente o no se documenta de manera adecuada, en parte por la falta de herramientas que lo permitan y en otra parte por la falta de cultura de la reproducibilidad en la generación de indicadores ya que en la mayoría de los casos se hace referencia a los datos y no al proceso de generación de los indicadores.</p>
<section id="investigación-reproducible" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="investigación-reproducible"><span class="header-section-number">3.1</span> Investigación reproducible</h2>
<p>El concepto de investigación reproducible ha cobrado relevancia en los últimos años, tanto en la academia como en la industria y esto se debe a la fricción que puede llegar a existir al momento de presentar resultados de investigación o generación indicadores relevantes para la toma de decisiones debido al proceso de generación de los mismos. Dentro de las diferentes disciplinas generar ambientes de trabajo reproducibles puede llegar a ser un desafío, ya que en la mayoría de los casos se utilizan diferentes herramientas, lenguajes de programación y bases de datos.</p>
<p>En la actualidad existen diferentes revistas científicas que promueven la investigación reproducible, herramientas, guías para buenas prácticas para trabajar con datos y código fuente como Sumatra <span class="citation" data-cites="davison2012">(<a href="#ref-davison2012" role="doc-biblioref">Davison &amp; Huth, 2012</a>)</span>, implementaciones de programación literal <span class="citation" data-cites="knuth1984">(<a href="#ref-knuth1984" role="doc-biblioref">Knuth, 1984</a>)</span> como RMarkdown <span class="citation" data-cites="allaire2024">(<a href="#ref-allaire2024" role="doc-biblioref">Allaire et&nbsp;al., 2024</a>)</span> o Jupyter Notebook <span class="citation" data-cites="kluyver2024">(<a href="#ref-kluyver2024" role="doc-biblioref">Kluyver et&nbsp;al., 2024</a>)</span> y diferentes implementaciones para gestionar dependencias de software como Anaconda <span class="citation" data-cites="anaconda2024">(<a href="#ref-anaconda2024" role="doc-biblioref">Anaconda, 2024</a>)</span>, aunque algunas de ellas se han vuelto herramientas de pago o ya no existen en la actualidad, mas referencias y casos de uso pueden encontrarse en <span class="citation" data-cites="stodden2014">(<a href="#ref-stodden2014" role="doc-biblioref">Stodden et&nbsp;al., 2014</a>)</span>.</p>
<p>Antes de continuar es necesario definir conceptos fundamentales en el ámbito de la investigación reproducible, tales como la <em>Reproducibilidad</em> que refiere a la capacidad de poder repetir los resultados de un estudio, experimento o la obtención de un indicador. Si bien la reproducibilidad en un artículo de investigación científica al utilizar indicadores tanto en contextos académicos como en aplicaciones de monitoreo o divulgación de información, rara vez se documenta o se menciona de que manera se generó ese resultado haciendo referencia únicamente a los datos y rara vez al código fuente. Aún compartiendo el código fuente, esto aún no suficiente para poder reproducir un estudio o un indicador por incompatibilidades de versiones de software, cambios en la estructura de los datos interpretaciones de los datos, estilos de programación, entre otros pudiendo llevar mucho tiempo y esfuerzo para poder replicar un resultado.</p>
<p>El proceso de tratamiento de datos y limpieza forma parte de lo que se conoce como <em>publicaciones grises</em> <span class="citation" data-cites="vilhuber2020">(<a href="#ref-vilhuber2020" role="doc-biblioref">Vilhuber, 2020</a>)</span>. Este concepto se refiere a la publicación de datos, código y reportes que no son publicaciones formales, pero son esenciales para generar conocimiento científico. En su mayoría al no tener una revisión por pares o una forma estandarizada esto se incluye de forma muy dispar o sin ningún tipo de documentación para poder ser reproducido y esto forma una gran parte de la investigación científica que no se encuentra aprovechada.</p>
<p>Existen diversas iniciativas destinadas a fomentar la reproducibilidad en la ciencia, lo que ha llevado a las revistas a establecer políticas de datos y código abierto. Sin embargo, persisten desafíos en la generación de indicadores sociales, ya que como se menciono anteriormente no basta con hacer referencia a los datos, como se señala en <span class="citation" data-cites="bechhofer2013">(<a href="#ref-bechhofer2013" role="doc-biblioref">Bechhofer et&nbsp;al., 2013</a>)</span>; además de publicar el artículo junto a los datos, es necesario vincular los objetos de investigación (Research Objects <strong>RO</strong>), existen diferentes plataformas que permiten la publicación de estos objetos como <a href="https://zenodo.org/"><strong>Zenodo</strong></a> y <a href="https://figshare.com/"><strong>Figshare</strong></a> o <a href="https://osf.io/"><strong>OSF</strong></a> que permiten la integración de datos, código e interacción con repositorios con control de versiones como GitHub o GitLab.</p>
<p>De conceptos generales sobre reproducibilidad es importante contar con un flujo de trabajo (<em>Workflow managment System</em> <span class="citation" data-cites="prabhu2020">(<a href="#ref-prabhu2020" role="doc-biblioref">Prabhu &amp; Fox, 2020</a>)</span>) para la obtención de estimadores en el procesamiento de encuestas por muestreo ya que el indicador final es el resultado de una serie de pasos que se deben seguir de manera ordenada y documentada para poder ser auditados y replicados en diferentes contextos, inspirado en <span class="citation" data-cites="sandve2013">(<a href="#ref-sandve2013" role="doc-biblioref">Sandve et&nbsp;al., 2013</a>)</span> se pueden considerar algunas buenas prácticas para la generación de indicadores:</p>
<ul>
<li><p><strong>Para cada resultado, se debe tener un respaldo de como fue construido</strong>: Al trabajar con lenguajes de programación como R, los script de código fuente son un respaldo de como obtener cierto resultado, sin embargo, esto puede estar ligado a tu estilo de programación y la versión de los paquetes que se utilizan.</p></li>
<li><p><strong>Crear manuales en la manipulación de datos</strong>: Es importante resumir cada paso por mas mínimo que sea en la transformación de variables, esto permite entender todo el proceso de generación de un indicador.</p></li>
<li><p><strong>Guardar las versiones de los paquetes utilizados</strong>: Al trabajar con R, es importante guardar las versiones de los paquetes que se utilizan, esto permite que en un futuro se pueda replicar el proceso de generación de indicadores, para esto puede utilizarse herramientas como <code>renv</code> <span class="citation" data-cites="ushey2023">(<a href="#ref-ushey2023" role="doc-biblioref">Ushey &amp; Wickham, 2023</a>)</span> un paquete que permite crear ambientes locales con versiones especificas de paquetes de R, <code>venv</code> <span class="citation" data-cites="pythonsoftwarefoundation2024">(<a href="#ref-pythonsoftwarefoundation2024" role="doc-biblioref">Python Software Foundation, 2024</a>)</span> que son ambientes virtuales en python o Docker <span class="citation" data-cites="merkel2014">(<a href="#ref-merkel2014" role="doc-biblioref">Merkel, 2014</a>)</span> para poder emular un ambiente de trabajo en diferentes sistemas operativos.</p></li>
<li><p><strong>Guardar pasos intermedios, en un formato estandar</strong>: Al trabajar con encuestas por muestreo y para crear indicadores sencillos se realizan dos grandes tipos de operaciones: crear grupos o categorías o realizar operaciones matemáticas, es importante guardar estos pasos en un formato estándar para poder ser reutilizados en diferentes contextos.</p></li>
<li><p><strong>Compartir las ejecuciones y scripts</strong>: Es importante que los scripts de código fuente estén disponibles para que puedan ser auditados y replicados en diferentes contextos.</p></li>
</ul>
<section id="conceptos-clave" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="conceptos-clave"><span class="header-section-number">3.1.1</span> Conceptos clave</h3>
<p><code>metasurvey</code> se basa en las buenas prácticas mencionadas anteriormente y permite crear herramientas de flujo de trabajo siguiendo los siguientes principios:</p>
<ul>
<li><p><strong>Reusable</strong>: Se separa el proceso de transformación de variables en <code>Steps</code> que refiere a transformaciones de columnas, estos procedimientos pueden ser comunes tanto en diferentes encuestas como en diferentes indicadores. Estos <code>Steps</code> pueden ser reutilizados en diferentes <code>Recipes</code> para calcular indicadores de mercados de trabajo, pobreza, e incluso aplicarlos en varias encuestas simultáneamente mediante un <code>Workflow</code>.</p></li>
<li><p><strong>Repetible</strong>: Al tener un proceso definido en un <code>Workflow</code>, es posible repetir el proceso de generación de indicadores de la misma manera y automatizar la generación de reportes.</p></li>
<li><p><strong>Referenciable</strong> y <strong>Acreditable</strong>: Al contar con un <code>Workflow</code>, es posible hacer referencia al proceso de generación de indicadores indicando todos los pasos seguidos y el autor o equipo que lo realizó. Además, se puede acreditar a los autores de los <code>Steps</code> y <code>Recipes</code> que se utilizaron en el proceso.</p></li>
</ul>
</section>
<section id="workflow-reproducible" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="workflow-reproducible"><span class="header-section-number">3.1.2</span> Workflow reproducible</h3>
<p>El concepto de <em>Workflow</em> no es nuevo y exclusivo en la comunidad científica, en la actualidad en la industria de la ciencia de datos se han desarrollado diferentes herramientas para la gestión de flujos de trabajo para el procesamiento de datos, con diferentes enfoques y objetivos. <code>metaSurvey</code> se inspira en diferentes herramientas como <a href="https://github.com/apache/airflow"><strong>Apache AirFlow</strong></a> <span class="citation" data-cites="apachea">(<a href="#ref-apachea" role="doc-biblioref"><em>Apache Airflow Documentation</em>, s.&nbsp;f.</a>)</span> que es una plataforma de orquestación de flujos de trabajo de código abierto, <a href="https://greatexpectations.io/"><strong>Great Expectations</strong></a> <span class="citation" data-cites="expectations2024">(<a href="#ref-expectations2024" role="doc-biblioref">Expectations, 2024</a>)</span> que es una biblioteca de validación de datos para la generación de reportes de calidad de datos y <a href="https://www.gnu.org/software/make/"><strong>Make</strong></a> que es una herramienta de automatización de flujos de trabajo que se basa en la definición de reglas y dependencias.</p>
<p>En el ámbito del aprendizaje automático existe un gran esfuerzo para poder desgranar y documentar los modelos conocido como <strong>Model Cards</strong> <span class="citation" data-cites="mitchell2019">(<a href="#ref-mitchell2019" role="doc-biblioref">Mitchell et&nbsp;al., 2019</a>)</span> donde se hace un detalle de los algoritmos utilizados, las métricas de evaluación, los datos utilizados y su procesamiento, siendo esto el análogo a los <code>Steps</code> y <code>Recipes</code> de <code>metaSurvey</code>. Este concepto se ha extendido siendo un estándar en la industria y siendo adoptado por diferentes organizaciones como <a href="https://modelcards.withgoogle.com/"><strong>Google</strong></a> y <a href="https://huggingface.co/docs/hub/en/model-cards"><strong>Hugging Face</strong></a>.</p>
<p>Tomando en cuenta estos conceptos, <code>metaSurvey</code> tiene disponible la posibilidad de generar, compartir y visualizar los flujos de trabajo de manera gráfica permitiendo la transparencia y auditabilidad de los procesos de generación de indicadores.</p>
</section>
</section>
<section id="investigación-reproducible-en-r" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="investigación-reproducible-en-r"><span class="header-section-number">3.2</span> Investigación reproducible en R</h2>
<p>Dentro de CRAN existe una guía sobre conjunto de paquetes y herramientas con objetivos comunes denominado <strong>Task Views</strong> que agrupa paquetes de R que se utilizan para un propósito específico. En el Task View de <a href="https://cran.r-project.org/web/views/ReproducibleResearch.html">Reproducible Research</a> se encuentran diferentes paquetes que permiten la generación de reportes dinámicos, la gestión de flujos de trabajo y la generación de documentos interactivos aunque también existen herramientas para la gestión de flujos de trabajo generales como <code>targets</code> <span class="citation" data-cites="landau2021">(<a href="#ref-landau2021" role="doc-biblioref">Landau, 2021</a>)</span> y <code>drake</code> <span class="citation" data-cites="landau2018">(<a href="#ref-landau2018" role="doc-biblioref">Landau, 2018</a>)</span>, <code>metaSurvey</code> fue inspirado en los conceptos y la forma de trabajo de estos paquetes.</p>
<p>Los conceptos de metaprogramación y programación orientada a objetos fue inspirado en el paquete <code>mlr3pipelines</code> <span class="citation" data-cites="binder2021">(<a href="#ref-binder2021" role="doc-biblioref">Binder et&nbsp;al., 2021</a>)</span> que permite la creación de flujos de trabajo para el preprocesamiento de datos y la generación de modelos de aprendizaje automático, aquí se definen <code>PipeOps</code> que son operaciones que se pueden aplicar a los datos y se pueden combinar en un <code>Graph</code> que define el flujo de trabajo para ello se definen clases y métodos que permiten una fácil extensión por parte del usuario y la creación de flujos de trabajo complejos.</p>
<p>Dentro de la comunidad existen organizaciones como <a href="https://ropensci.org/">ROpenSci</a> que promueven la ciencia abierta y la reproducibilidad en la investigación científica, proporcionando herramientas y guías para promover la ciencia abierta mediante R. Esta organización promueve la creación de paquetes donde además de la guias sobre el desarrollo de paquetes y la revisión de los mismos, se promueve la creación de paquetes que sean de utilidad para la comunidad científica definiendo estándares de calidad y documentación. Para formar parte de ROpenSci, se sigue una evaluación entre pares y una revisión de la calidad del paquete, además de la documentación y la calidad del código complementado con tests automatizados.</p>
<section id="herramientas-para-el-procesamiento-de-encuestas" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="herramientas-para-el-procesamiento-de-encuestas"><span class="header-section-number">3.2.1</span> Herramientas para el procesamiento de encuestas</h3>
<p>En el ámbito de las encuestas por muestreo, existen diferentes paquetes que permiten el procesamiento de encuestas por muestreo o la generación de estadisiticas oficiales, esto se puede ver en el Task View de <a href="https://cran.r-project.org/web/views/OfficialStatistics.html">Official Statistics &amp; Survey Methodology</a> donde se encuentran diferentes tipos de paquetes desde la preparación de formularios, calibración, análisis de datos, acceso a datos oficiales, entre otros.</p>
<p>Para el procesamiento de encuestas por muestreo, existe una serie de paquetes que permiten implementar la metodología de encuestas por muestreo como puede ser el caso de <code>survey</code> <span class="citation" data-cites="lumley2024">(<a href="#ref-lumley2024" role="doc-biblioref">Lumley, 2024</a>)</span> que permite el análisis de encuestas complejas, <code>srvyr</code> <span class="citation" data-cites="ellis2023">(<a href="#ref-ellis2023" role="doc-biblioref">Ellis &amp; Schneider, 2023</a>)</span> aunque estos son utilizados en el proceso final o de inferencia y no en el proceso de la construcción y limpieza de los datos como si lo hace <code>ech</code> <span class="citation" data-cites="detomasi2020">(<a href="#ref-detomasi2020" role="doc-biblioref">Detomasi, 2020</a>)</span> que tiene diferentes funciones para la ECH y permite al usuario crear variables referidas a Vivienda, Educación, Mercado de Trabajo, Ingresos y Pobreza algo similar con <code>eph</code> <span class="citation" data-cites="kozlowski2020">(<a href="#ref-kozlowski2020" role="doc-biblioref">Kozlowski et&nbsp;al., 2020</a>)</span> que permite la descarga de datos de la EPH y la creación de variables para analizar la pobreza y el mercado de trabajo.</p>
<p>Este ultimo grupo de paquetes o <strong>caja de herramientas</strong> tienen la limitación que no permiten la reutilización de los pasos de limpieza y transformación de los datos de forma sencilla y nativa, además de no poder visualizar el flujo de trabajo de manera gráfica, lo que dificulta la auditoría y la replicabilidad de los procesos de generación indicadores, <code>metasurvey</code> busca llenar este vacío permitiendo la reutilización de los pasos de limpieza y transformación de los datos, la visualización del flujo de trabajo y la generación de reportes de manera sencilla.</p>
</section>
</section>
<section id="diseño-de-encuestas-y-estimación-de-varianza" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="diseño-de-encuestas-y-estimación-de-varianza"><span class="header-section-number">3.3</span> Diseño de encuestas y estimación de varianza</h2>
<p>Como fue introducido en el capitulo anterior y en la sección de antecedentes es sencillo obtener estimaciones puntuales, sin embargo, es necesario presentar una medida de precisión de la estimación ya que en algunos casos puede ser que el tamaño de la muestra no sea suficiente para obtener estimaciones precisas. En el caso de las encuestas por muestreo, es necesario tener en cuenta el diseño de la encuesta, la estratificación, la ponderación y el efecto de conglomerados, ya que estos factores influyen en la precisión de la estimación. Para ello, es necesario contar con alguna metodología que permita estimar varianzas ya que para diseños complejos o estadísticos no lineales, la estimación de varianzas no es trivial.</p>
<p>En la actualidad, existen diferentes métodos para la estimación de varianzas, aunque en la mayoría de los casos se utilizan métodos de remuestreo como el Boostrap o el Jacknife, sin embargo existen diferentes ideas o propuestas como se menciona en <span class="citation" data-cites="deville1998">(<a href="#ref-deville1998" role="doc-biblioref">Deville &amp; Tille, 1998</a>)</span> y <span class="citation" data-cites="deville2005">(<a href="#ref-deville2005" role="doc-biblioref">Deville &amp; Tillé, 2005</a>)</span> que demuestran con resultados númericos estimadores del tipo <strong>H-T</strong> bajo un diseño balanceado puede aproximarse desde el enfoque de regresión o calibración. Además existen estimadores alternativos donde complementan métodos de remuestreo para aproximar probabilidades de inclusión de segundo órden <span class="citation" data-cites="escobar2013">(<a href="#ref-escobar2013" role="doc-biblioref">Escobar &amp; Berger, 2013</a>)</span> utilizando ciertas aproximaciones límites <span class="citation" data-cites="hajek1964">(<a href="#ref-hajek1964" role="doc-biblioref">Hajek, 1964</a>)</span>.</p>
<p>Cada metodología depende de cada diseño y variables a estimar, por esto es que existen diferentes metodologías y paquetes como <code>gustave</code> <span class="citation" data-cites="gustave2024">(<a href="#ref-gustave2024" role="doc-biblioref"><strong>gustave2024?</strong></a>)</span> , <code>vardpoor</code> <span class="citation" data-cites="vardpoor2024">(<a href="#ref-vardpoor2024" role="doc-biblioref"><strong>vardpoor2024?</strong></a>)</span>, <code>svrep</code> <span class="citation" data-cites="svrep2024">(<a href="#ref-svrep2024" role="doc-biblioref"><strong>svrep2024?</strong></a>)</span> y <code>samplingVarEst</code> <span class="citation" data-cites="samplingVarEst2024">(<a href="#ref-samplingVarEst2024" role="doc-biblioref"><strong>samplingVarEst2024?</strong></a>)</span>, aunque existen similitudes entre implementaciones y métodos es dificil encontrar una implementación que permita la estimación de varianzas de manera sencilla y que permita la reutilización de los pasos de limpieza y transformación de los datos.</p>
<p>En capitulos posteriores se presentará la implementación de conceptos de workflows, metaprogramación y metodologías de estimación de varianzas en <code>metasurvey</code> para la generación de indicadores sociales.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-allaire2024" class="csl-entry" role="listitem">
Allaire, J., Xie, Y., McPherson, J., Luraschi, J., Ushey, K., &amp; Atkins, A. (2024). <em>RMarkdown</em>. <a href="https://rmarkdown.rstudio.com/">https://rmarkdown.rstudio.com/</a>
</div>
<div id="ref-anaconda2024" class="csl-entry" role="listitem">
Anaconda, Inc. (2024). <em>Anaconda Distribution</em>. <a href="https://www.anaconda.com/">https://www.anaconda.com/</a>
</div>
<div id="ref-apachea" class="csl-entry" role="listitem">
<em>Apache Airflow Documentation</em>. (s.&nbsp;f.). <a href="https://airflow.apache.org/docs/latest/">https://airflow.apache.org/docs/latest/</a>
</div>
<div id="ref-bechhofer2013" class="csl-entry" role="listitem">
Bechhofer, S., Buchan, I., De Roure, D., Missier, P., Ainsworth, J., Bhagat, J., Couch, P., Cruickshank, D., Delderfield, M., Dunlop, I., Gamble, M., Michaelides, D., Owen, S., Newman, D., Sufi, S., &amp; Goble, C. (2013). Why linked data is not enough for scientists. <em>Future Generation Computer Systems</em>, <em>29</em>(2), 599-611. <a href="https://doi.org/10.1016/j.future.2011.08.004">https://doi.org/10.1016/j.future.2011.08.004</a>
</div>
<div id="ref-binder2021" class="csl-entry" role="listitem">
Binder, M., Pfisterer, F., Lang, M., Schneider, L., Kotthoff, L., &amp; Bischl, B. (2021). mlr3pipelines - Flexible Machine Learning Pipelines in R. <em>Journal of Machine Learning Research</em>, <em>22</em>(184), 1-7. <a href="https://jmlr.org/papers/v22/21-0281.html">https://jmlr.org/papers/v22/21-0281.html</a>
</div>
<div id="ref-davison2012" class="csl-entry" role="listitem">
Davison, A. P., &amp; Huth, J. E. (2012). Sumatra: A toolkit for reproducible research. <em>arXiv preprint arXiv:1207.5548</em>.
</div>
<div id="ref-detomasi2020" class="csl-entry" role="listitem">
Detomasi, G. M. &amp;. R. (2020). <em>ech: Caja de herramientas para procesar la Encuesta Continua de Hogares</em>. <a href="https://github.com/calcita/ech">https://github.com/calcita/ech</a>
</div>
<div id="ref-deville1998" class="csl-entry" role="listitem">
Deville, J.-C., &amp; Tille, Y. (1998). Unequal Probability Sampling Without Replacement Through a Splitting Method. <em>Biometrika</em>, <em>85</em>(1), 89-101. <a href="https://www.jstor.org/stable/2337311">https://www.jstor.org/stable/2337311</a>
</div>
<div id="ref-deville2005" class="csl-entry" role="listitem">
Deville, J.-C., &amp; Tillé, Y. (2005). Variance approximation under balanced sampling. <em>Journal of Statistical Planning and Inference</em>, <em>128</em>(2), 569-591. <a href="https://doi.org/10.1016/j.jspi.2003.11.011">https://doi.org/10.1016/j.jspi.2003.11.011</a>
</div>
<div id="ref-ellis2023" class="csl-entry" role="listitem">
Ellis, G. F., &amp; Schneider, B. (2023). <em>srvyr: ’dplyr’-Like Syntax for Summary Statistics of Survey Data</em>. <a href="https://CRAN.R-project.org/package=srvyr">https://CRAN.R-project.org/package=srvyr</a>
</div>
<div id="ref-escobar2013" class="csl-entry" role="listitem">
Escobar, E. L., &amp; Berger, Y. G. (2013). A new replicate variance estimator for unequal probability sampling without replacement. <em>The Canadian Journal of Statistics / La Revue Canadienne de Statistique</em>, <em>41</em>(3), 508-524. <a href="https://www.jstor.org/stable/43186201">https://www.jstor.org/stable/43186201</a>
</div>
<div id="ref-expectations2024" class="csl-entry" role="listitem">
Expectations, G. (2024). <em>Great Expectations Documentation</em>. Superconductive. <a href="https://docs.greatexpectations.io">https://docs.greatexpectations.io</a>
</div>
<div id="ref-hajek1964" class="csl-entry" role="listitem">
Hajek, J. (1964). Asymptotic Theory of Rejective Sampling with Varying Probabilities from a Finite Population. <em>The Annals of Mathematical Statistics</em>, <em>35</em>(4), 1491-1523. <a href="https://doi.org/10.1214/aoms/1177700375">https://doi.org/10.1214/aoms/1177700375</a>
</div>
<div id="ref-kluyver2024" class="csl-entry" role="listitem">
Kluyver, T., Ragan-Kelley, B., Pérez, F., Granger, B., Bussonnier, M., Frederic, J., Kelley, K., Hamrick, J., Grout, J., Corlay, S., &amp; others. (2024). <em>Jupyter Notebook</em>. <a href="https://jupyter.org/">https://jupyter.org/</a>
</div>
<div id="ref-knuth1984" class="csl-entry" role="listitem">
Knuth, D. E. (1984). Literate programming. <em>The Computer Journal</em>, <em>27</em>(2), 97111.
</div>
<div id="ref-kozlowski2020" class="csl-entry" role="listitem">
Kozlowski, D., Tiscornia, P., Weksler, G., Rosati, G., &amp; Shokida, N. (2020). <em>eph: Argentina’s Permanent Household Survey Data and Manipulation Utilities</em>. <a href="https://holatam.github.io/eph/">https://holatam.github.io/eph/</a>
</div>
<div id="ref-landau2018" class="csl-entry" role="listitem">
Landau, W. M. (2018). The drake R package: a pipeline toolkit for reproducibility and high-performance computing. <em>Journal of Open Source Software</em>, <em>3</em>(21). <a href="https://doi.org/10.21105/joss.00550">https://doi.org/10.21105/joss.00550</a>
</div>
<div id="ref-landau2021" class="csl-entry" role="listitem">
Landau, W. M. (2021). The targets R package: a dynamic Make-like function-oriented pipeline toolkit for reproducibility and high-performance computing. <em>Journal of Open Source Software</em>, <em>6</em>(57), 2959. <a href="https://doi.org/10.21105/joss.02959">https://doi.org/10.21105/joss.02959</a>
</div>
<div id="ref-lumley2024" class="csl-entry" role="listitem">
Lumley, T. (2024). <em>survey: analysis of complex survey samples</em>.
</div>
<div id="ref-merkel2014" class="csl-entry" role="listitem">
Merkel, D. (2014). Docker: lightweight linux containers for consistent development and deployment. <em>Linux journal</em>, <em>2014</em>(239), 2.
</div>
<div id="ref-mitchell2019" class="csl-entry" role="listitem">
Mitchell, M., Wu, S., Zaldivar, A., Barnes, P., Vasserman, L., Hutchinson, B., Spitzer, E., Raji, I. D., &amp; Gebru, T. (2019). <em>Model Cards for Model Reporting</em>. 220-229. <a href="https://doi.org/10.1145/3287560.3287596">https://doi.org/10.1145/3287560.3287596</a>
</div>
<div id="ref-prabhu2020" class="csl-entry" role="listitem">
Prabhu, A., &amp; Fox, P. (2020). <em>Reproducible Workflow</em>. <a href="http://arxiv.org/abs/2012.13427">http://arxiv.org/abs/2012.13427</a>
</div>
<div id="ref-pythonsoftwarefoundation2024" class="csl-entry" role="listitem">
Python Software Foundation. (2024). <em>Python 3 Documentation: venv - Creation of virtual environments</em>. Python Software Foundation. <a href="https://docs.python.org/3/library/venv.html">https://docs.python.org/3/library/venv.html</a>
</div>
<div id="ref-sandve2013" class="csl-entry" role="listitem">
Sandve, G. K., Nekrutenko, A., Taylor, J., &amp; Hovig, E. (2013). Ten Simple Rules for Reproducible Computational Research. <em>PLOS Computational Biology</em>, <em>9</em>(10), e1003285. <a href="https://doi.org/10.1371/journal.pcbi.1003285">https://doi.org/10.1371/journal.pcbi.1003285</a>
</div>
<div id="ref-stodden2014" class="csl-entry" role="listitem">
Stodden, V., Leisch, F., &amp; Peng, R. D. (2014). <em>Implementing Reproducible Research</em>. CRC Press.
</div>
<div id="ref-ushey2023" class="csl-entry" role="listitem">
Ushey, K., &amp; Wickham, H. (2023). <em>renv: Project Environments</em>. <a href="https://CRAN.R-project.org/package=renv">https://CRAN.R-project.org/package=renv</a>
</div>
<div id="ref-vilhuber2020" class="csl-entry" role="listitem">
Vilhuber, L. (2020). Reproducibility and Replicability in Economics. <em>Harvard Data Science Review</em>, <em>2</em>(4). <a href="https://doi.org/10.1162/99608f92.4f6b9e67">https://doi.org/10.1162/99608f92.4f6b9e67</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/metaSurveyR\/metaSurvey");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/chapter2.html" class="pagination-link" aria-label="Marco conceptual">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Marco conceptual</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter4.html" class="pagination-link" aria-label="Metodología">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Metodología</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/metaSurveyR/informe_tfg/edit/main/chapters/chapter3.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/metaSurveyR/informe_tfg/blob/main/chapters/chapter3.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li><li><a href="https://github.com/metaSurveyR/informe_tfg/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div></div></footer></body></html>