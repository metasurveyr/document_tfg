<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introducción – metasurvey</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/chapter2.html" rel="next">
<link href="../index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/chapter1.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">metasurvey</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/metaSurveyR/metasurvey" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../metasurvey.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Descripción del proyecto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Marco conceptual</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Marco teórico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Desarrollo y metodología</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Casos de uso</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Pasos a futuro</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/bibliography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biblografía</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Appendices/AppendixA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Apendice</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#motivación" id="toc-motivación" class="nav-link active" data-scroll-target="#motivación"><span class="header-section-number">1.1</span> Motivación</a></li>
  <li><a href="#contexto" id="toc-contexto" class="nav-link" data-scroll-target="#contexto"><span class="header-section-number">1.2</span> Contexto</a></li>
  <li><a href="#antecedentes-e-implementaciones-similares" id="toc-antecedentes-e-implementaciones-similares" class="nav-link" data-scroll-target="#antecedentes-e-implementaciones-similares"><span class="header-section-number">1.3</span> Antecedentes e implementaciones similares</a></li>
  <li><a href="#propuesta" id="toc-propuesta" class="nav-link" data-scroll-target="#propuesta"><span class="header-section-number">1.4</span> Propuesta</a></li>
  <li><a href="#definición-del-alcance" id="toc-definición-del-alcance" class="nav-link" data-scroll-target="#definición-del-alcance"><span class="header-section-number">1.5</span> Definición del Alcance</a></li>
  <li><a href="#desarrollo-del-paquete-metasurvey" id="toc-desarrollo-del-paquete-metasurvey" class="nav-link" data-scroll-target="#desarrollo-del-paquete-metasurvey"><span class="header-section-number">1.6</span> Desarrollo del paquete <code>metasurvey</code></a></li>
  <li><a href="#esquema-del-documento" id="toc-esquema-del-documento" class="nav-link" data-scroll-target="#esquema-del-documento"><span class="header-section-number">1.7</span> Esquema del documento</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/metaSurveyR/metasurvey/edit/main/chapters/chapter1.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/metaSurveyR/metasurvey/blob/main/chapters/chapter1.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li><li><a href="https://github.com/metaSurveyR/metasurvey/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-Chapter1" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<style type="text/css">
p {
  text-align: justify
}
</style>
</div>
<div class="status">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nota
</div>
</div>
<div class="callout-body-container callout-body">
<p>Este capítulo está en proceso de validación. Cualquier comentario es bienvenido</p>
</div>
</div>
</div>
<p>En este trabajo se presenta el paquete <code>metasurvey</code>, una herramienta para el procesamiento y obtención de indicadores a partir de encuestas por muestreo. El paquete proporciona al usuario control total y transparencia en el proceso de transformación de microdatos a indicadores, permitiendo validar y entender su construcción. Además, facilita la creación de variables sintéticas, recodificación de variables con criterios complejos y el tratamiento de variables continuas como el ingreso salarial mediante una metodología rigurosa y fácil de implementar. Es crucial que este proceso sea transparente y entendible para el usuario.</p>
<section id="motivación" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="motivación"><span class="header-section-number">1.1</span> Motivación</h2>
<p>Las encuestas por muestreo son una herramienta fundamental para la obtención de información sobre una población de interés, ya que permiten obtener datos a partir de una muestra representativa. Sin embargo, el procesamiento de encuestas puede ser tedioso, propenso a errores y difícil de transparentar y reproducir, especialmente al generar indicadores como tasas de mercado laboral, ingreso salarial e índices de pobreza <span class="citation" data-cites="vilhuber2020">(<a href="bibliography.html#ref-vilhuber2020" role="doc-biblioref">Vilhuber 2020</a>)</span>.</p>
<p>Dado que las herramientas actuales no permiten flexibilidad al usuario, <code>metasurvey</code> se presenta como una alternativa que incorpora flexibilidad y transparencia en el proceso de transformación de microdatos a indicadores.</p>
</section>
<section id="contexto" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="contexto"><span class="header-section-number">1.2</span> Contexto</h2>
<p>En la teoría de la inferencia de poblaciones finitas, es crucial considerar la incertidumbre y los errores asociados a las estimaciones producidas. Generalmente, esto no es tomado en cuenta por usuarios no expertos en metodología de muestreo, lo que puede llevar a conclusiones erróneas. En algunos casos, el estimador asociado a la estimación puede tener una alta variabilidad o haber sido calculado sin considerar el diseño muestral correcto.</p>
<p>Es importante distinguir entre los enfoques de inferencia estadística <strong>model-based inference</strong> y <strong>design-based inference</strong> <span class="citation" data-cites="lumley2011">(<a href="bibliography.html#ref-lumley2011" role="doc-biblioref">Lumley 2011</a>)</span>. En el primer enfoque, se asume que la población de interés puede modelarse mediante un modelo probabilístico, y se obtienen estimaciones de los parámetros del modelo mediante técnicas de inferencia estadística. En el segundo enfoque, se asume que la población de interés es finita y se obtienen estimaciones de los parámetros de la población mediante técnicas de muestreo.</p>
<p>En este trabajo se mencionará intensivamente el concepto de peso o ponderador y su importancia en la estimación de varianzas y errores asociados a las estimaciones. En estadística, existen diferentes conceptos referidos a ponderadores o pesos, entre ellos (basado en <span class="citation" data-cites="lumley2011">(<a href="bibliography.html#ref-lumley2011" role="doc-biblioref">Lumley 2011</a>)</span>):</p>
<ul>
<li><strong>Pesos muestrales</strong>: Refieren a la cantidad de veces que un individuo de la población de interés está representado en la muestra. Estos pesos provienen del diseño muestral, ya sea por el inverso de las probabilidades de selección, ajustes por no respuesta, entre otros.</li>
<li><strong>Pesos de precisión</strong>: Relacionados con la variabilidad que tiene una observación sobre la estimación de un parámetro.</li>
<li><strong>Pesos de frecuencia</strong>: Refieren a la cantidad de veces que aparece un individuo en una muestra y se resumen para incluir en un único registro.</li>
</ul>
<p>Es importante hacer esta distinción ya que, tomando en cuenta los pesos en cualquiera de sus definiciones, en la mayoría de los casos <strong>se pueden obtener estimaciones puntuales correctas</strong>. Sin embargo, como se mencionó anteriormente, llegar a medidas de incertidumbre como errores estándar e intervalos de confianza puede ser incorrecto.</p>
<p>Además de la inferencia, es crucial considerar el proceso de transformación de los microdatos a indicadores para interpretar correctamente los indicadores y realizar comparaciones a lo largo del tiempo. Muchas veces, diferentes usuarios realizan el mismo esfuerzo de construcción de indicadores de manera independiente y sin compartir el código fuente o la metodología, ya que cada uno utiliza su propio estilo de programación o diferentes paquetes estadísticos, en su mayoría propietarios como SPSS, SAS o STATA. Aunque el usuario puede compartir la sintaxis para su construcción, esta está ligada al software y depende de que el usuario tenga el software instalado con una licencia activa.</p>
<p>En los últimos años, el uso de R <span class="citation" data-cites="rcoreteam2023">(<a href="bibliography.html#ref-rcoreteam2023" role="doc-biblioref">R Core Team 2023</a>)</span> ha crecido exponencialmente en la comunidad científica, especialmente en estadística y ciencia de datos. R es un lenguaje de programación de código abierto ampliamente utilizado para el análisis de datos, estadística y aprendizaje automático. En R, se utiliza el concepto de <em>paquete</em> para referirse a una colección de funciones, métodos y clases que extienden las funcionalidades de R propuestas por la comunidad de usuarios. En este sentido, <code>metasurvey</code> busca ser una herramienta relevante para el trabajo con encuestas por muestreo en diversas disciplinas, solucionando las limitaciones mencionadas anteriormente.</p>
<p>Es importante definir el concepto de Estadística Computacional y su diferencia con Computación Estadística <span class="citation" data-cites="cook2014">(<a href="bibliography.html#ref-cook2014" role="doc-biblioref">Cook 2014</a>)</span>, siendo este trabajo un aporte a la Estadística Computacional. La Estadística Computacional se refiere a la implementación de algoritmos y métodos estadísticos en un lenguaje de programación, mientras que la Computación Estadística se refiere a la utilización de herramientas computacionales para resolver problemas estadísticos. R permite realizar tanto Estadística Computacional como Computación Estadística, ya que cuenta con una amplia variedad de paquetes que permiten implementar algoritmos y métodos estadísticos y realizar análisis de datos de manera eficiente y reproducible.</p>
</section>
<section id="antecedentes-e-implementaciones-similares" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="antecedentes-e-implementaciones-similares"><span class="header-section-number">1.3</span> Antecedentes e implementaciones similares</h2>
<p>Actualmente existen diversos esfuerzos para facilitar el procesamiento de encuestas. Estos pueden clasificarse principalmente en dos tipos de paquetes:</p>
<ul>
<li><p><strong>Paquetes para inferencia estadística</strong>: Implementan metodologías de inferencia en muestreo de poblaciones finitas, como <code>survey</code> <span class="citation" data-cites="lumley2024">(<a href="bibliography.html#ref-lumley2024" role="doc-biblioref">Lumley 2024</a>)</span>, <code>gustave</code> <span class="citation" data-cites="chevalier2023">(<a href="bibliography.html#ref-chevalier2023" role="doc-biblioref">Chevalier 2023</a>)</span>, <code>vardpoor</code> <span class="citation" data-cites="breidaks2020">(<a href="bibliography.html#ref-breidaks2020" role="doc-biblioref">Breidaks, Liberts, y Ivanova 2020</a>)</span>, <code>svrep</code> <span class="citation" data-cites="schneider2023">(<a href="bibliography.html#ref-schneider2023" role="doc-biblioref">Schneider 2023</a>)</span> y <code>weights</code>.</p></li>
<li><p><strong>Paquetes para encuestas específicas</strong>: Permiten acceder y manipular datos de encuestas particulares:</p>
<ul>
<li><code>ech</code>: Procesa la <strong>Encuesta Continua de Hogares (ECH)</strong> del Instituto Nacional de Estadística (INE) de Uruguay <span class="citation" data-cites="detomasi2020">(<a href="bibliography.html#ref-detomasi2020" role="doc-biblioref">Detomasi 2020</a>)</span></li>
<li><code>eph</code>: Procesa la <strong>Encuesta Permanente de Hogares (EPH)</strong> del Instituto Nacional de Estadística y Censos (INDEC) de Argentina <span class="citation" data-cites="kozlowski2020">(<a href="bibliography.html#ref-kozlowski2020" role="doc-biblioref">Kozlowski et&nbsp;al. 2020</a>)</span></li>
<li><code>tidycensus</code>: Obtiene datos del <strong>Censo de Estados Unidos</strong> <span class="citation" data-cites="walker2024">(<a href="bibliography.html#ref-walker2024" role="doc-biblioref">Walker y Herman 2024</a>)</span></li>
<li><code>casen</code>: Procesa la <strong>Encuesta de Caracterización Socioeconómica Nacional (CASEN)</strong> del Ministerio de Desarrollo Social y Economía de Chile <span class="citation" data-cites="vargas2024">(<a href="bibliography.html#ref-vargas2024" role="doc-biblioref">Vargas 2024</a>)</span></li>
</ul></li>
</ul>
<p>Sin embargo, estos últimos tienen limitaciones en cuanto a la flexibilidad y transparencia del proceso de transformación de los microdatos a indicadores de interés, como puede ser el índice de pobreza, tasas del mercado laboral, ingreso salarial, etc. En general, sus implementaciones son muy sensibles a la estructura y las variables que componen la encuesta, un cambio en la estructura de la encuesta suele implicar una actualización del paquete utilizado para obtener los indicadores en la nueva edición de la encuesta, lo que resulta poco flexible ante cambios en la estructura, que pueden ser frecuentes en la práctica. Además en las implementaciones actuales, el usuario cuenta con una función de alto nivel que actúa como una caja negra, donde no se permite modificar el código para adaptarlo a sus necesidades o entender cada paso que se realiza para obtener el indicador sin tener que leer el código fuente o la documentación adjunta.</p>
</section>
<section id="propuesta" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="propuesta"><span class="header-section-number">1.4</span> Propuesta</h2>
<p>Para científicos sociales, es importante tener en cuenta que el proceso de transformación de los microdatos a indicadores requiere de un conocimiento profundo de la encuesta y en su mayoría no es de conocimiento general. Es de interés obtener información histórica de indicadores y en general es un proceso tedioso y propenso a errores, especialmente si proviene de encuestas donde su estructura y/o forma de preguntar o su codificación puede cambiar con el tiempo. Esto resulta en un proceso extenso y difícil de entender hasta llegar a la construcción de esta serie de indicadores. Muchas veces, diferentes usuarios hacen el mismo proceso de construcción de indicadores de manera independiente y sin compartir el código fuente o la metodología de construcción de indicadores, ya que cada uno utiliza su propio estilo de programación o hasta diferentes paquetes estadísticos, en su mayoría propietarios como SPSS, SAS o STATA, donde si bien el usuario puede compartir la sintaxis para su construcción, esta está ligada al software y depende de que el usuario tenga el software instalado con una licencia activa y pueda correr el código.</p>
<p>En este sentido, es importante que el usuario pueda tener un control total sobre el proceso de transformación de los microdatos a indicadores, ya que esto permite que el usuario pueda validar y entender el proceso de construcción de indicadores, además de brindar una herramienta común libre de estilos de programación y definiendo con simples pasos el proceso de construcción de variables sintéticas, como recodificar variables creando grupos en base a criterios complejos, tratamiento de variables continuas como el ingreso salarial en base a una metodología rigurosa y fácil de referenciar en la implementación. Es crucial que este proceso sea transparente y entendible para el usuario. En capítulos posteriores se abordarán ejemplos con los paquetes mencionados anteriormente y se presentará el paquete <code>metasurvey</code> y su implementación de <em>recetas</em> para la construcción de indicadores mediante la meta-programación.</p>
<p>Al trabajar con encuestas por muestreo, es importante tener en cuenta la forma en la que se obtuvieron los datos y su proceso generador para poder realizar inferencias sobre la población de interés. En general, obtener estimaciones puntuales de estadísticos de totales, promedios o proporciones es relativamente sencillo, pero puede ser que se reporte una estimación donde no exista un tamaño de muestra suficiente para obtener una estimación confiable y/o que la variabilidad de la estimación sea alta y no sea recomendable su uso. En este sentido, es importante que el usuario no experto tenga de forma nativa una forma de obtener estimaciones puntuales y sus errores asociados de manera sencilla. Es común utilizar estimaciones puntuales sin tener una medida de incertidumbre o aún peor incluir una estimación del error estándar sin tener en cuenta el diseño muestral correcto, lo que puede llevar a conclusiones erróneas sobre la variabilidad de la estimación. <code>metasurvey</code> permite que el usuario pueda obtener estimaciones puntuales y sus errores asociados de forma nativa y con estos resultados hacer recomendaciones sobre la utilidad y confianza de la estimación mediante coeficientes de variación, intervalos de confianza, tamaño de muestra efectivo, entre otros sin tener que ser un experto en metodología de estimación de varianzas y remuestreo. En capítulos posteriores se abordarán ejemplos con los paquetes mencionados anteriormente y se presentará el paquete <code>metasurvey</code> y su implementación de estimaciones puntuales y sus errores asociados.</p>
</section>
<section id="definición-del-alcance" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="definición-del-alcance"><span class="header-section-number">1.5</span> Definición del Alcance</h2>
<p><code>metasurvey</code> está diseñado para científicos sociales, estadísticos y economistas que trabajan con encuestas por muestreo. Permite a estos usuarios manejar y transformar microdatos en indicadores de manera transparente, flexible y reproducible.</p>
</section>
<section id="desarrollo-del-paquete-metasurvey" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="desarrollo-del-paquete-metasurvey"><span class="header-section-number">1.6</span> Desarrollo del paquete <code>metasurvey</code></h2>
<p>El desarrollo de un paquete en R es un proceso que requiere contar con una idea bien formada y los medios para llevarla a cabo, es por esto que es importante contar con una metodología de trabajo ordenada, heredada del desarrollo de software convencional, ya que para la publicación y difusión del paquete se tienen que cumplir con ciertos estándares de calidad y documentación para que otros usuarios puedan utilizarlo. En este sentido, es importante tener en cuenta que el desarrollo de un paquete en R puede llevar tiempo y esfuerzo, a consecuencia de esto, en el documento se presentarán diferentes conceptos sobre metodología para el desarrollo de paquetes en R y se abordarán ejemplos con la implementación de <code>metasurvey</code>.</p>
<p>En este sentido, <code>metasurvey</code> pretende ser una herramienta relevante para el trabajo con encuestas por muestreo en general ya sea en las ciencias sociales o el uso genérico para otras disciplinas, buscando solucionar las limitaciones anteriormente mencionadas. Todo el proceso de transformación de los microdatos a indicadores se realiza a través de una serie de funciones que permiten al usuario tener un control total y transparente sobre el proceso de transformación de los microdatos a indicadores. Además, <code>metasurvey</code> permite que el usuario pueda realizar el proceso de transformación de los microdatos a indicadores de manera reproducible y transparente. El usuario puede compartir el código de una forma entendible, casi como un “recetario de cocina”. El procedimiento aplicado a los datos utilizados para obtener los indicadores se realiza mediante lo que denominamos steps y recipes, conformando así una especie de camino transparente para la construcción de indicadores. Esto permite compartir en forma visual un DAG (Directed Acyclic Graph) que permite visualizar el proceso de construcción de indicadores sin tener que abrir un script de R. En complemento al proceso de creación de variables, <code>metasurvey</code> permite que el usuario pueda obtener estimaciones puntuales y sus errores asociados de manera sencilla y brindar recomendaciones sobre la utilidad de la estimación en el caso de que se cuente con una variabilidad alta en la estimación, en base a recomendaciones a su coeficiente de variación o métricas similares.</p>
<p>El enfoque que permite la flexibilidad a la hora de construir los indicadores es la meta-programación. La meta-programación es un paradigma de programación que permite que un programa pueda modificar su estructura interna en tiempo de ejecución. En R, la meta-programación se realiza a través de las funciones <code>eval</code>, <code>parse</code>, <code>substitute</code>, <code>do.call</code> y <code>quote</code>, que permiten evaluar y parsear código de manera dinámica. En este sentido, <code>metasurvey</code> utiliza la meta-programación para permitir que el usuario pueda modificar el código que se utiliza para transformar los microdatos a indicadores, teniendo funciones de alto nivel similares a las que se utilizan en el paquete recipes de la librería <code>tidymodels</code> <span class="citation" data-cites="kuhn2024">(<a href="bibliography.html#ref-kuhn2024" role="doc-biblioref">Kuhn, Wickham, y Hvitfeldt 2024</a>)</span>.</p>
</section>
<section id="esquema-del-documento" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="esquema-del-documento"><span class="header-section-number">1.7</span> Esquema del documento</h2>
<p>El documento se estructura de la siguiente manera: en el siguiente capítulo se presentará un marco conceptual básico sobre el muestreo de poblaciones finitas, diferentes paradigmas de programación como puede ser la programación orientada a objetos, programación funcional y la meta-programación y como se utilizan en el desarrollo del paquete. Luego, se ahondará en antecedentes previos tanto en la parte de metodología de estimación de varianzas y paquetes e ideas similares donde se basa el desarrollo del paquete. Finalmente, se presentarán ejemplos de cómo utilizar el paquete <code>metasurvey</code> para construir indicadores de mercado laboral a partir de los microdatos de la <strong>ECH</strong> y para mostrar su flexibilidad, se incluirá un ejemplo con la <strong>EPH</strong>.</p>
<p>Este documento puede leerse en su formato de <a href="https://metasurveyr.github.io/informe_tfg/">pagina web</a> o en su formato de <a href="https://metasurveyr.github.io/informe_tfg/metasurvey.pdf">documento PDF</a>. Tanto el código fuente del paquete se encuentran disponibles de forma pública en el repositorio de <a href="https://github.com/metasurveyr/metasurvey">Github</a> y el código fuente de este documento se encuentra disponible en el <a href="https://github.com/metasurveyr/informe_tfg">repositorio</a>. Para la realización de este documento se utilizó <code>quarto</code> <span class="citation" data-cites="publishing2024">(<a href="bibliography.html#ref-publishing2024" role="doc-biblioref">Publishing 2024</a>)</span> para la generación de documentos dinámicos que permiten escribir texto junto con código R.</p>
<p>Para finalizar, es importante mencionar que el paquete <code>metasurvey</code> es un proyecto en desarrollo y se encuentra en una etapa temprana de desarrollo, por lo que se espera que en el futuro se realicen mejoras y se agreguen nuevas funcionalidades, por lo que se invita a la comunidad a colaborar en el desarrollo del paquete a través de la creación de <a href="https://github.com/metasurveyr/metasurvey/issues">issues</a> en el repositorio de GitHub o mediante <em>pull requests</em> con mejoras o nuevas funcionalidades.</p>
<p>Para poder continuar con el documento, se recomienda instalar metasurvey en su versión de desarrollo, para ello se puede ejecutar el siguiente <a href="#lst-install-cran" class="quarto-xref">código&nbsp;<span>1.1</span></a></p>
<div id="lst-install-cran" class="listing quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-lst figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-lst" id="lst-install-cran-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Código&nbsp;1.1: Instalación de metasurvey
</figcaption>
<div aria-describedby="lst-install-cran-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>branch <span class="ot">&lt;-</span> <span class="st">"develop"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>is_available <span class="ot">&lt;-</span> <span class="st">"metasurvey"</span> <span class="sc">%in%</span> <span class="fu">rownames</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">available.packages</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org/"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (is_available) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"metasurvey"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  remotes<span class="sc">::</span><span class="fu">install_github</span>(</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"metasurveyr/metasurvey"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">ref =</span> branch,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">force =</span> <span class="cn">TRUE</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Se instaló la versión de desarrollo de metasurvey"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</figure>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-breidaks2020" class="csl-entry" role="listitem">
Breidaks, Juris, Martins Liberts, y Santa Ivanova. 2020. <em>vardpoor: Estimation of indicators on social exclusion and poverty and its linearization, variance estimation</em>. Riga, Latvia: Central Statistical Bureau of Latvia. <a href="https://csblatvia.github.io/vardpoor/">https://csblatvia.github.io/vardpoor/</a>.
</div>
<div id="ref-chevalier2023" class="csl-entry" role="listitem">
Chevalier, Martin. 2023. <em>gustave: A User-Oriented Statistical Toolkit for Analytical Variance Estimation</em>. <a href="https://CRAN.R-project.org/package=gustave">https://CRAN.R-project.org/package=gustave</a>.
</div>
<div id="ref-cook2014" class="csl-entry" role="listitem">
Cook, Di. 2014. <span>«Statistical Computing Research |»</span>. <a href="http://dicook.org/2014/10/05/content/post/2014-10-5-statistical-computing/">http://dicook.org/2014/10/05/content/post/2014-10-5-statistical-computing/</a>.
</div>
<div id="ref-detomasi2020" class="csl-entry" role="listitem">
Detomasi, Gabriela Mathieu &amp; Richard. 2020. <span>«ech: Caja de herramientas para procesar la Encuesta Continua de Hogares»</span>. <a href="https://github.com/calcita/ech">https://github.com/calcita/ech</a>.
</div>
<div id="ref-kozlowski2020" class="csl-entry" role="listitem">
Kozlowski, Diego, Pablo Tiscornia, Guido Weksler, German Rosati, y Natsumi Shokida. 2020. <em>eph: Argentina’s Permanent Household Survey Data and Manipulation Utilities</em>. <a href="https://holatam.github.io/eph/">https://holatam.github.io/eph/</a>.
</div>
<div id="ref-kuhn2024" class="csl-entry" role="listitem">
Kuhn, Max, Hadley Wickham, y Emil Hvitfeldt. 2024. <em>recipes: Preprocessing and Feature Engineering Steps for Modeling</em>. <a href="https://github.com/tidymodels/recipes">https://github.com/tidymodels/recipes</a>.
</div>
<div id="ref-lumley2011" class="csl-entry" role="listitem">
Lumley, Thomas. 2011. <em>Complex Surveys: A Guide to Analysis Using R</em>. John Wiley &amp; Sons.
</div>
<div id="ref-lumley2024" class="csl-entry" role="listitem">
———. 2024. <span>«survey: analysis of complex survey samples»</span>.
</div>
<div id="ref-publishing2024" class="csl-entry" role="listitem">
Publishing, Quarto. 2024. <em>Quarto</em>. <a href="https://www.quartoknows.com/">https://www.quartoknows.com/</a>.
</div>
<div id="ref-rcoreteam2023" class="csl-entry" role="listitem">
R Core Team. 2023. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-schneider2023" class="csl-entry" role="listitem">
Schneider, Benjamin. 2023. <span>«svrep: Tools for Creating, Updating, and Analyzing Survey Replicate Weights»</span>. <a href="https://CRAN.R-project.org/package=svrep">https://CRAN.R-project.org/package=svrep</a>.
</div>
<div id="ref-vargas2024" class="csl-entry" role="listitem">
Vargas, Mauricio. 2024. <em>casen: Metodos De Estimacion Con Disenio Probabilistico y Estratificado en Encuesta CASEN (Estimation Methods with Probabilistic Stratified Sampling in CASEN Survey)</em>. <a href="https://pacha.dev/casen/">https://pacha.dev/casen/</a>.
</div>
<div id="ref-vilhuber2020" class="csl-entry" role="listitem">
Vilhuber, Lars. 2020. <span>«Reproducibility and Replicability in Economics»</span>. <em>Harvard Data Science Review</em> 2 (4). <a href="https://doi.org/10.1162/99608f92.4f6b9e67">https://doi.org/10.1162/99608f92.4f6b9e67</a>.
</div>
<div id="ref-walker2024" class="csl-entry" role="listitem">
Walker, Kyle, y Matt Herman. 2024. <em>tidycensus: Load US Census Boundary and Attribute Data as ’tidyverse’ and ’sf’-Ready Data Frames</em>. <a href="https://walker-data.com/tidycensus/">https://walker-data.com/tidycensus/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/metaSurveyR\/metasurvey");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../index.html" class="pagination-link" aria-label="Descripción del proyecto">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Descripción del proyecto</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/chapter2.html" class="pagination-link" aria-label="Marco conceptual">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Marco conceptual</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/metaSurveyR/metasurvey/edit/main/chapters/chapter1.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/metaSurveyR/metasurvey/blob/main/chapters/chapter1.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li><li><a href="https://github.com/metaSurveyR/metasurvey/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li></ul></div></div></div></footer></body></html>